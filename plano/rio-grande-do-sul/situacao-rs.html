<section class="br-container-lg">
  <div class="report-container">
    <h2 class="title-text">Situação no RS</h2>
    <div class="report-card-list">
      <div class="report-card-item">
        <a
          class="card-link"
          href="https://www.gov.br/ana/pt-br/previsoes-e-inundacoes"
        >
          <span class="report-card-front">
            <i class="fa-solid fa-water"></i>
            <span>Previsões e Inundações</span>
          </span>
          <span class="report-card-back">
            <span
              >ANA publica dados em tempo real de monitoramento do nível e
              previsões de inundação no RS</span
            >
          </span>
        </a>
        <button
          class="info-card-button background-active"
          id="switch-report-info"
        >
          <i class="fa-solid fa-info fa-sm"></i>
        </button>
      </div>
      <div class="report-card-item">
        <a
          class="card-link"
          href="https://www.gov.br/cemaden/pt-br/assuntos/riscos-geo-hidrologicos"
        >
          <span class="report-card-front">
            <i class="fa-solid fa-circle-exclamation"></i>
            <span>Alerta de Riscos</span>
          </span>
          <span class="report-card-back">
            <span> Riscos geo-hidrológicos informados pelo Cemaden/MCTI</span>
          </span>
        </a>
        <button
          class="info-card-button background-active"
          id="switch-report-info"
        >
          <i class="fa-solid fa-info fa-sm"></i>
        </button>
      </div>
      <div class="report-card-item">
        <a class="card-link" href="https://portal.inmet.gov.br/">
          <span class="report-card-front">
            <i class="fa-solid fa-droplet"></i> <span>Previsão do Tempo</span>
          </span>
          <span class="report-card-back">
            <span> Previsão do tempo informada pelo INMET/MAPA </span>
          </span>
        </a>
        <button
          class="info-card-button background-active"
          id="switch-report-info"
        >
          <i class="fa-solid fa-info fa-sm"></i>
        </button>
      </div>
      <div class="report-card-item">
        <a
          class="card-link"
          href="https://disasterscharter.org/pt/web/guest/activations/-/article/flood-in-brazil-activation-875-"
        >
          <span class="report-card-front">
            <i class="fa-solid fa-satellite"></i>
            <span>Imagens via Satélite</span>
          </span>
          <span class="report-card-back">
            <span>
              Mapas oficiais, produzidos pelo INPE/MCTI, Universidades e
              diversas agências espaciais
            </span>
          </span>
        </a>
        <button
          class="info-card-button background-active"
          id="switch-report-info"
        >
          <i class="fa-solid fa-info fa-sm"></i>
        </button>
      </div>
      <div class="report-card-item">
        <a
          class="card-link"
          href="https://www.sgb.gov.br/sace/index_bacias_monitoradas.php"
        >
          <span class="report-card-front">
            <i class="fa-solid fa-water"></i> <span>Nível dos Rios</span>
          </span>
          <span class="report-card-back">
            <span>
              O SACE é a plataforma desenvolvida pelo Serviço Geológico do
              Brasil (CPRM/MME) para disponibilizar todas as informações geradas
              no contexto dos Sistemas de Alerta Hidrológico (SAHs)
            </span>
          </span>
        </a>
        <button
          class="info-card-button background-active"
          id="switch-report-info"
        >
          <i class="fa-solid fa-info fa-sm"></i>
        </button>
      </div>
      <div class="report-card-item">
        <a
          class="card-link"
          href="https://www.snirh.gov.br/hidrotelemetria/Mapa.aspx"
        >
          <span class="report-card-front">
            <i class="fa-solid fa-chart-simple"></i>
            <span>Monitoramento Hidrológico</span>
          </span>
          <span class="report-card-back">
            <span>
              Disponibilização de informações hidrometeorológicas feita pela ANA
            </span>
          </span>
        </a>
        <button
          class="info-card-button background-active"
          id="switch-report-info"
        >
          <i class="fa-solid fa-info fa-sm"></i>
        </button>
      </div>
    </div>
  </div>
  <div id="blogContainer"></div>
  <div class="divider"></div>
  <secion class="subcontent-section">
    <div class="home-sections-content information-section">
      <img style=height:24px;width:100%;object-fit:cover; alt=imagers
      src=https://brasilparticipativo.presidencia.gov.br/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWViIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--b529d66240858217bd7a1b613dac32bab20b50c7/6.png
      class=image-content />
      <div class="home-sections-content information-section cards-section">
        <h2>Canais de emergências oficiais</h2>
        <div class="cards-container">
          <a
            class="content-container"
            href="https://www.gov.br/pt-br/servicos/denunciar-violacao-de-direitos-humanos"
          >
            <div class="content-box">
              <h2>Ligue 100</h2>
              <p>direitos humanos</p>
            </div>
          </a>
          <a
            class="content-container"
            href="https://www.gov.br/mdh/pt-br/assuntos/denuncie-violencia-contra-a-mulher/violencia-contra-a-mulher"
          >
            <div class="content-box">
              <h2>ligue 180</h2>
              <p>Central de atendimento à mulher</p>
            </div>
          </a>
          <a class="content-container" href="https://www.bombeiros.rs.gov.br/">
            <div class="content-box">
              <h2>Ligue 193</h2>
              <p>Bombeiros RS</p>
            </div>
          </a>
          <a
            class="content-container"
            href="https://www.brigadamilitar.rs.gov.br/numeros-alternativos-190"
          >
            <div class="content-box">
              <h2>Disque 190</h2>
              <p>Polícia Militar</p>
            </div>
          </a>
        </div>
      </div>
      <img style=height:24px;width:100%;object-fit:cover; alt=imagers
      src=https://brasilparticipativo.presidencia.gov.br/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBcWViIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--b529d66240858217bd7a1b613dac32bab20b50c7/6.png
      class=image-content />
    </div>
  </secion>
  <section class="logos__section">
    <div class="logos__container">
      <a href="https://www.gov.br/pt-br" data-asw-orgfontsize="14"
        ><img
          alt="governo federal logo"
          src="https://brasilparticipativo.presidencia.gov.br/rails/active_storage/blobs/redirect/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBc3ljIiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--dce22bca6bfc8919b166189814133934aefba1bc/gov-fed.png"
          style="filter: invert(0); height: 100px"
          id="logo-governo-federal"
        />
      </a>
    </div>
  </section>
</section>
<script>
  function fetchAllPages(url) {
    return fetch(url)
      .then((response) => {
        if (!response.ok) {
          throw new Error(
            `Error fetching the page. Response status: ${response.status}`
          );
        }
        return response.text();
      })
      .then((html) => {
        let resultHTML = html;
        const tempElement = document.createElement("div");
        tempElement.innerHTML = resultHTML;
        const pagination = tempElement.querySelector(".pagination-container");
        if (!pagination) return html;
        const lastPageLink = pagination
          .querySelector(".pagination-last a")
          .getAttribute("href");
        const regex = /page=(\d+)/;
        const match = lastPageLink.match(regex);
        const baseURL = "https://brasilparticipativo.presidencia.gov.br";
        if (match) {
          const totalPageNumber = parseInt(match[1], 10);
          const fetchPromises = [];
          for (let i = 2; i <= totalPageNumber; i++) {
            const newURL = `${baseURL}${lastPageLink.replace(
              regex,
              `page=${i}`
            )}`;
            fetchPromises.push(
              fetchHTML(newURL)
                .then((pageHtml) => {
                  resultHTML += pageHtml;
                })
                .catch((error) => {
                  console.error("Error fetching page:", error);
                })
            );
          }
          return Promise.all(fetchPromises).then(() => resultHTML);
        } else {
          console.log("Page number not found");
          return resultHTML;
        }
      })
      .catch((error) => {
        throw new Error(`Error fetching the page: ${error.message}`);
      });
  }
  function fetchHTML(url) {
    return fetch(url)
      .then((response) => {
        if (!response.ok) {
          throw new Error(
            `Error fetching the page. Response status: ${response.status}`
          );
        }
        return response.text();
      })
      .then((html) => {
        return html;
      })
      .catch((error) => {
        throw new Error(`Error fetching the page: ${error.message}`);
      });
  }
  
  function parseDateFromText(dateString) {
    const [day, month, year] = dateString.split("/").map(Number);
    const fullYear = year < 100 ? 2000 + year : year;
    return new Date(fullYear, month - 1, day);
  }

  function formatDateToDDMMYY(date) {
    const day = date.getDate().toString().padStart(2, "0");
    const month = (date.getMonth() + 1).toString().padStart(2, "0"); 
    const year = date.getFullYear().toString().substring(2); 
    return `${day}/${month}/${year}`;
  }

  function getElements(originalNewsElement) {
    const titleElement = originalNewsElement.querySelector('.news-title');

    let titleContent = '';
    let hrefPost = '#';

    if (titleElement) {
      titleContent = titleElement.textContent.trim();
      hrefPost = titleElement.getAttribute('href');
    }

    const descriptionElement = originalNewsElement.querySelector('.news-description');
    let dateExtracted = new Date(0);
    let subtitleContent = '';

    if (descriptionElement) {
      const fullDescription = descriptionElement.textContent.trim();
      subtitleContent = fullDescription.split('-')[1].trim();
      dateExtracted = parseDateFromText(fullDescription.split("-")[0].trim());
    }
    else if (originalNewsElement.querySelector('.br-card-content')){
      // mobile devices
      subtitleContent = originalNewsElement.querySelector('.br-card-content').textContent.trim();
      const tempElement = originalNewsElement.querySelector('.br-card-date');
      dateExtracted = parseDateFromText(tempElement.textContent.trim());
    }

    const imageElement = originalNewsElement.querySelector('.news-cover-image');
    let imageUrl = '#';
    
    if (imageElement){
      imageUrl = imageElement.getAttribute('href');
    }

    return { titleContent, hrefPost, subtitleContent, imageUrl, dateExtracted}
  }

  function generateBlogHTML(url, originalHTML) {
    const tempElement = document.createElement("div");
    tempElement.innerHTML = originalHTML;
    const originalNewsElements = tempElement.querySelectorAll(".news-item");
    const resultHTMLArray = [];
    let latestDate = new Date(0);
    originalNewsElements.forEach((originalNewsElement) => {
      const { titleContent, hrefPost, subtitleContent, imageUrl, dateExtracted } = getElements(originalNewsElement);

      if (dateExtracted > latestDate) {
        latestDate = dateExtracted;
      }
      
      const htmlTemplate = ` <div class="report-content"> <h3 class="report-number">${subtitleContent}</h3> <p class="report-description">${titleContent}</p> </div> `;
      resultHTMLArray.push(htmlTemplate);
    });
    let resultHTML = ` <div class="last-time-updated"> Atualizado em ${formatDateToDDMMYY(
      latestDate
    )} </div> <div class="report-section" > `;
    resultHTML += resultHTMLArray.join("\n");
    resultHTML += "</div></div></section>";
    return resultHTML;
  }
  function generateBlog(url, title) {
    fetchAllPages(url)
      .then((html) => {
        return generateBlogHTML(url, html);
      })
      .then((newsContent) => {
        if (newsContent !== "error") {
          let blogContent = `<section class=""> <div class="report-container"> <h2 class="title-text">${title}</h2> <h3 class="report-subtitle">Fonte: Defesa Civil Rio Grande do Sul</h3> </div> <div class="">`;
          blogContent += newsContent;
          const blogContainer = document.querySelector("#blogContainer");
          if (blogContainer) {
            blogContainer.innerHTML = blogContent;
          } else {
            console.error('Element with id "blogContainer" not found.');
          }
        } else {
          console.error("Error fetching news.");
        }
      })
      .catch((error) => {
        console.error("Error:", error);
      });
  }
  const url =
    "https://brasilparticipativo.presidencia.gov.br/processes/unidospelors/f/114/";
  const title = "Monitoramento CENAD";
  generateBlog(url, title);
</script>
<style>
  .divider {
    border-bottom: 1px solid #cccccc;
    margin: 64px 0px;
  }
  .cards-section {
    display: flex;
    flex-direction: column;
    align-items: center;
    padding: 24px;
    justify-content: space-evenly;
    background-color: #f3f7fb;
    h2 {
      font-weight: 800;
      font-size: 36px;
      padding: 0;
      margin: 0;
      margin-bottom: 16px;
    }
  }
  .cards-container {
    display: flex;
    justify-content: center;
    gap: 24px;
    width: 100%;
  }
  .content-container {
    display: flex;
    background-color: white;
    padding: 10px 16px;
    justify-content: center;
    align-items: center;
  }
  .content-box {
    display: flex;
    flex-direction: column;
    align-items: center;
    color: #0c326f;
    h2 {
      font-size: 16px;
      font-weight: 600;
      color: #0c326f;
      padding: 0;
      margin: 0;
    }
    p {
      font-size: 14px;
      margin: 0;
      color: #0c326f;
      font-weight: 500;
    }
  }
  @media (max-width: 1045px) {
    .content-container {
      margin-bottom: 12px;
    }
    .cards-container {
      flex-direction: column;
    }
  }</style
><style>
  .report-section {
    display: grid;
    grid-template-columns: repeat(auto-fill, 200px);
    gap: 16px;
    margin: 24px 0px;
    justify-content: center;
  }
  .report-content {
    display: flex;
    flex-direction: column;
    justify-content: flex-start;
    align-items: center;
  }
  .report-number {
    font-size: 32px;
    font-weight: 700;
  }
  .report-description {
    font-weight: 500;
    font-size: 20px;
    color: #0c326f;
    text-align: center;
  }
  .last-time-updated {
    border-bottom: 1px #333333 solid;
    border-top: 1px #333333 solid;
    padding: 12px;
  }
  .center-container {
    display: flex;
    justify-content: center;
    align-items: center;
    flex-direction: column;
  }
  .title-text {
    font-weight: bold;
    padding: 0px;
  }
  .report-subtitle {
    padding: 0px;
    margin: 0px;
    text-transform: uppercase;
    font-size: 16px;
    font-weight: 400;
    color: #1b1b1b;
  }
  .title-container {
    display: flex;
    align-items: center;
    flex-direction: column;
    h2 {
      margin: 0;
    }
  }
  .title-header {
    display: flex;
    align-items: center;
    flex-direction: row;
    width: 100%;
    h3 {
      margin: 0;
      font-weight: bold;
      font-size: 1rem;
      color: var(--gray-70);
      padding: 0 0.875rem;
      white-space: nowrap;
    }
  }
  .title-header::before {
    content: "";
    width: 100%;
    height: 1px;
    background-color: var(--gray-10);
  }
  .title-header::after {
    content: "";
    width: 100%;
    height: 1px;
    background-color: var(--gray-10);
  }
  .itens-list {
    display: flex;
    width: 100%;
    padding: 1rem 0;
    gap: 1rem;
    flex-wrap: wrap;
    justify-content: center;
  }
  .list-item {
    box-shadow: 0 3px 6px 0 rgba(0, 0, 0, 0.16);
    border-radius: 0.5rem;
    padding: 1.85rem 2rem;
    line-height: 2rem;
    color: var(--pure-100);
    height: auto;
    margin: 0 1rem;
    text-align: center;
    text-decoration: none;
    transition: all 0.3s ease;
    height: 12rem;
    max-width: 25rem;
    width: 100%;
    display: flex;
    flex-direction: column;
    transition: transform 0.3s ease;
  }
  .list-item:hover {
    transform: scale(1.05);
  }
  .categories-item {
    font-size: 0.875rem;
    font-weight: bold;
    color: var(--gray-70);
    display: block;
    text-align: left;
    display: flex;
    justify-content: space-between;
    i {
      color: var(--primary);
      rotate: -30deg;
    }
  }
  .list-item-text {
    font-size: 1rem;
    color: var(--blue-warm-vivid-80);
    text-align: center;
    font-weight: bold;
  }
  .report-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    padding: 1rem 0;
    gap: 1rem;
  }
  .report-card-list {
    display: flex;
    gap: 2rem;
    flex-wrap: wrap;
    justify-content: center;
    width: 100%;
  }
  .report-card-item {
    position: relative;
    width: 100%;
    max-width: 13rem;
    height: 12rem;
    box-shadow: 0 3px 6px 0 rgba(0, 0, 0, 0.16);
    border-radius: 0.5rem;
    overflow: hidden;
    display: flex;
    justify-content: center;
    align-items: center;
    transition: transform 0.3s ease;
    .info-card-button {
      padding: 0.75rem;
      position: absolute;
      display: flex;
      justify-content: center;
      align-items: center;
      top: 0.5rem;
      right: 0.5rem;
      color: white;
      border-radius: 50%;
      border: none;
      cursor: pointer;
      transition: background-color 0.3s ease;
      height: 0.5rem;
      width: 0.5rem;
      z-index: 2;
    }
    .background-active {
      background-color: var(--primary);
    }
    .card-link {
      width: 100%;
      height: 100%;
      display: flex;
      justify-content: center;
      align-items: center;
      text-decoration: none;
      color: var(--blue-warm-vivid-80);
      background-color: var(--gray-2);
      transition: background-color 0.3s ease;
      i {
        font-size: 3rem;
      }
    }
  }
  .report-card-item:hover {
    transform: scale(1.05);
  }
  .report-card-front {
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    z-index: 2;
    span {
      font-weight: bold;
    }
  }
  .report-card-back {
    display: flex;
    width: 100%;
    height: 100%;
    color: white;
    padding: 1rem;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    gap: 1rem;
    background-color: var(--gray-70);
    display: none;
    transition: all 0.3s ease;
    span {
      font-weight: bold;
    }
  }
</style>
<script>
  const infoCardButtons = document.querySelectorAll(".info-card-button");
  infoCardButtons.forEach((button) => {
    button.addEventListener("click", () => {
      const cardItem = button.parentElement;
      const cardFront = cardItem.querySelector(".report-card-front");
      const cardBack = cardItem.querySelector(".report-card-back");
      if (cardFront.style.display !== "none") {
        button.classList.remove("background-active");
        cardFront.style.display = "none";
        cardBack.style.display = "flex";
      } else {
        button.classList.add("background-active");
        cardFront.style.display = "flex";
        cardBack.style.display = "none";
      }
      const icon = button.querySelector("i");
      if (icon.classList.contains("fa-info")) {
        icon.classList.remove("fa-info");
        icon.classList.add("fa-times");
      } else {
        icon.classList.remove("fa-times");
        icon.classList.add("fa-info");
      }
    });
  });
</script>
